(function(e){function t(t){for(var a,s,l=t[0],i=t[1],c=t[2],_=0,p=[];_<l.length;_++)s=l[_],o[s]&&p.push(o[s][0]),o[s]=0;for(a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a]);u&&u(t);while(p.length)p.shift()();return n.push.apply(n,c||[]),r()}function r(){for(var e,t=0;t<n.length;t++){for(var r=n[t],a=!0,l=1;l<r.length;l++){var i=r[l];0!==o[i]&&(a=!1)}a&&(n.splice(t--,1),e=s(s.s=r[0]))}return e}var a={},o={1:0},n=[];function s(t){if(a[t])return a[t].exports;var r=a[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.m=e,s.c=a,s.d=function(e,t,r){s.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},s.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/static/";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],i=l.push.bind(l);l.push=t,l=l.slice();for(var c=0;c<l.length;c++)t(l[c]);var u=i;n.push([7,0]),r()})({"00LD":function(e,t,r){},"3gUL":function(e,t,r){},7:function(e,t,r){e.exports=r("Vtdi")},"7yGw":function(e,t,r){"use strict";var a=r("qj7S"),o=r.n(a);o.a},M1ow:function(e,t,r){},RF58:function(e,t,r){},V6YJ:function(e,t,r){"use strict";var a=r("RF58"),o=r.n(a);o.a},Vtdi:function(e,t,r){"use strict";r.r(t);r("VRzm");var a=r("Kw5r"),o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"app"}},[r("el-container",{attrs:{id:"elcontainer1"}},[r("el-aside",{attrs:{width:"200px"}},[r("el-menu",{staticClass:"el-menu-vertical-demo",attrs:{id:"elmenu1","default-active":e.current_active,"background-color":"#545c64","text-color":"#fff",align:"left","active-text-color":"#ffd04b",router:""}},[r("el-menu-item",{attrs:{index:"1",route:"/index"}},[r("i",{staticClass:"el-icon-menu"}),e._v(" "),r("span",{attrs:{slot:"title"},slot:"title"},[e._v("首页")])]),e._v(" "),r("el-menu-item",{attrs:{index:"2",route:"/projects"}},[r("i",{staticClass:"el-icon-document"}),e._v(" "),r("span",{attrs:{slot:"title"},slot:"title"},[e._v("项目管理")])])],1)],1),e._v(" "),r("el-container",{attrs:{id:"elcontainer2"}},[r("router-view",{attrs:{id:"header"}}),e._v(" "),r("el-footer",{attrs:{height:"20px"}},[e._v("PyScraper Copyright ©nikan 859905874@qq.com")])],1)],1)],1)},n=[],s={name:"app",components:{},computed:{current_active:function(){var e=this.$router.history.current.fullPath,t={"/index":"1",projects:"2","/databases":"3"};return t[e]}}},l=s,i=(r("ZL7j"),r("KHd+")),c=Object(i["a"])(l,o,n,!1,null,null,null),u=c.exports,_=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"database"}},[r("el-tab-pane",{attrs:{label:"政府关键词库",name:"gov_lexicon"}},[r("el-table",{staticStyle:{width:"100%"},attrs:{id:"lexicontable",data:e.gov_lexicon_data.slice((e.lexicon_currentPage-1)*e.lexicon_pagesize,e.lexicon_currentPage*e.lexicon_pagesize),stripe:"","default-sort":{prop:"update_timestamp",order:"descending"}}},[r("el-table-column",{attrs:{prop:"pattern",label:"匹配词"}}),e._v(" "),r("el-table-column",{attrs:{prop:"correct_word",label:"正确词"}}),e._v(" "),r("el-table-column",{attrs:{prop:"domain",label:"域名"}}),e._v(" "),r("el-table-column",{attrs:{prop:"update_timestamp",label:"更新时间"}}),e._v(" "),r("el-table-column",{attrs:{fixed:"right",label:"操作",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(r){e.deleteRule(t.row.rule_id)}}},[e._v("删除")])]}}])})],1),e._v(" "),r("div",{attrs:{id:"letPaginationBottom"}}),e._v(" "),r("el-pagination",{attrs:{id:"ele_pagination","current-page":e.lexicon_currentPage,"page-sizes":[5,9,10],"page-size":e.lexicon_pagesize,layout:"lexicon_total, sizes, prev, pager, next, jumper",lexicon_total:e.lexicon_total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),r("el-tab-pane",[r("span",{attrs:{slot:"label"},slot:"label"},[r("i",{staticClass:"el-icon-circle-plus-outline"}),e._v("添加规则")]),e._v(" "),r("el-form",{ref:"gov_rule_form",attrs:{inline:!0,model:e.gov_rule_form}},[r("el-tag",{staticStyle:{margin:"10px"},attrs:{type:"success"}},[e._v("示例： 匹配词：中*国 正确词：中华人民共和国\n                ")]),e._v(" "),e._l(e.gov_rule_form.gov_rules,function(t,a){return r("div",[r("el-form-item",{attrs:{label:"匹配词",rules:{required:!0,message:"匹配词不能为空",trigger:"blur"},prop:"gov_rules."+a+".0"}},[r("el-input",{model:{value:t[0],callback:function(r){e.$set(t,0,r)},expression:"gov_rule[0]"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"正确词",rules:{required:!0,message:"正确词不能为空",trigger:"blur"},prop:"gov_rules."+a+".1"}},[r("el-input",{model:{value:t[1],callback:function(r){e.$set(t,1,r)},expression:"gov_rule[1]"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"网站地址",rules:[{required:!0,message:"网站地址不能为空",trigger:"blur"},{type:"url",message:"请输入正确的网站地址",trigger:["blur","change"]}],prop:"gov_rules."+a+".2"}},[r("el-input",{model:{value:t[2],callback:function(r){e.$set(t,2,r)},expression:"gov_rule[2]"}})],1),e._v(" "),r("el-button",{on:{click:function(r){r.preventDefault(),e.removeRule(t)}}},[e._v("删除")])],1)}),e._v(" "),r("el-button",{on:{click:function(t){return t.preventDefault(),e.addRule(t)}}},[e._v("新增规则")]),e._v(" "),r("el-button",{staticStyle:{"margin-top":"12px"},attrs:{type:"primary"},on:{click:function(t){e.lexicon_submitForm("gov_rule_form")}}},[e._v("立即添加\n                ")])],2)],1)],1)},p=[],d=r("vDqi"),m=r.n(d),g={name:"Gov_lexicon",created:function(){this.fetch_lexicon_data()},data:function(){return{activeName:"gov_lexicon",gov_lexicon_data:[],gov_rule_form:{gov_rules:[["","",""]]},lexicon_currentPage:1,lexicon_pagesize:9}},computed:{lexicon_total:function(){return this.gov_lexicon_data.length}},methods:{fetch_lexicon_data:function(){var e=this;m.a.get("/gov_lexicon").then(function(t){e.gov_lexicon_data=t.data}).catch(function(t){console.log(t),e.$message.error({message:"获取政府词库列表失败啦，检查下你的网络吧"})})},lexicon_submitForm:function(e){var t=this;this.$refs[e].validate(function(r){if(!r)return t.$message.error({message:"请先正确填写规则"}),!1;m.a.put("/gov_lexicon",JSON.stringify(t.gov_rule_form),{headers:{"Content-Type":"application/json"}}).then(function(){t.$message.success({message:"成功添加规则至词库"}),t.resetForm(e),t.fetch_lexicon_data()}).catch(function(){t.$message.error({message:"添加规则失败啦"})})})},resetForm:function(e){this.$refs[e].resetFields()},handleSizeChange:function(e){this.lexicon_pagesize=e,console.log("每页 ".concat(e," 条"))},handleCurrentChange:function(e){this.lexicon_currentPage=e,console.log("当前页: ".concat(e))},removeRule:function(e){var t=this.gov_rule_form.gov_rules.indexOf(e);-1!==t&&this.gov_rule_form.gov_rules.splice(t,1)},addRule:function(){var e=this.gov_rule_form.gov_rules;0!==e.length?e.push(["","",e[e.length-1][2]]):e.push(["","",""])},deleteRule:function(e){var t=this;m.a.delete("/gov_lexicon/"+e).then(function(){t.$message.success({message:"成功删除规则"}),t.fetch_lexicon_data()}).catch(function(){t.$message.error({message:"删除规则失败，请检查网络"})})}}},f=g,v=(r("eN0a"),Object(i["a"])(f,_,p,!1,null,"03ebc234",null)),h=v.exports,b=r("jE9Z"),x=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-collapse",{on:{change:e.handleChange},model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},[r("el-collapse-item",{attrs:{title:"项目数量",name:"1"}},[r("div",[e._v("目前总共拥有"+e._s(e.statistics.project_num)+"个项目。")])]),e._v(" "),r("el-collapse-item",{attrs:{title:"爬取数据总量",name:"2"}},[r("div",[e._v("目前总共爬取了"+e._s(e.statistics.all_result_num)+"条数据。")])]),e._v(" "),r("el-collapse-item",{attrs:{title:"访问页面总量",name:"3"}},[r("div",[e._v("目前总共爬取了"+e._s(e.statistics.all_task_num)+"个页面。")])]),e._v(" "),r("el-collapse-item",{attrs:{title:"显示正在运行的项目数量",name:"4"}},[r("div",[e._v("目前正在运行的项目数量为"+e._s(e.statistics.running_project_num)+"。")])])],1)],1)},y=[],j={name:"Index",created:function(){this.fetchData()},data:function(){return{activeNames:["1","2","3","4"],statistics:{project_num:"",all_result_num:"",all_task_num:"",running_project_num:""}}},methods:{fetchData:function(){var e=this;m.a.get("/statistics").then(function(t){e.statistics=t.data}).catch(function(t){console.log(t),e.$message.error({message:"获取统计情况失败啦，检查下你的网络吧"})})},handleChange:function(e){console.log(e)}}},w=j,k=Object(i["a"])(w,x,y,!1,null,null,null),F=k.exports,$=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"projects"}},[r("router-link",{attrs:{to:"/create_gov_project"}},[r("el-button",{attrs:{type:"primary"}},[e._v("新建政府项目")])],1),e._v(" "),r("div",{},[r("el-table",{staticStyle:{width:"100%"},attrs:{data:e.show_projects.slice((e.currentPage-1)*e.pagesize,e.currentPage*e.pagesize),stripe:"","default-sort":{prop:"project_id",order:"descending"}}},[r("el-table-column",{attrs:{prop:"'tag",label:"标签",width:"180"}}),e._v(" "),r("el-table-column",{attrs:{prop:"project_name",label:"项目名称",width:"180"}}),e._v(" "),r("el-table-column",{attrs:{prop:"status",label:"状态"}}),e._v(" "),r("el-table-column",{attrs:{fixed:"right",label:"操作",width:"400"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(r){e.see(t.row)}}},[e._v("查看")]),e._v(" "),r("el-button",{attrs:{type:"primary",size:"small",disabled:"运行"==t.row.status},on:{click:function(r){e.start(t.row)}}},[e._v("开始\n                    ")]),e._v(" "),r("el-button",{attrs:{type:"primary",size:"small",disabled:"停止"==t.row.status},on:{click:function(r){e.stop(t.row)}}},[e._v("停止\n                    ")]),e._v(" "),r("el-button",{attrs:{type:"primary",size:"small",disabled:"运行"==t.row.status},on:{click:function(r){e.delete_project(t.row)}}},[e._v("删除\n                    ")])]}}])})],1)],1),e._v(" "),r("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[5,9,10],"page-size":e.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)},z=[];r("rE2o"),r("ioFf"),r("rGqo"),r("Vd3H");function C(e,t){return e.sort(function(e,r){var a=e[t],o=r[t];return a<o?-1:a>o?1:0})}var S={name:"Projects",created:function(){this.fetchData()},data:function(){return{projects:[],projects_status:{stop:"停止",pause:"暂停",start:"运行"},currentPage:1,pagesize:9}},computed:{show_projects:function(){var e=[],t=!0,r=!1,a=void 0;try{for(var o,n=this.projects[Symbol.iterator]();!(t=(o=n.next()).done);t=!0){var s=o.value,l={project_id:s.project_id,tag:s.tag,project_name:s.project_name,status:this.projects_status[s.status],update_timestamp:s.update_timestamp};e.push(l)}}catch(e){r=!0,a=e}finally{try{t||null==n.return||n.return()}finally{if(r)throw a}}return e},total:function(){return this.projects.length}},methods:{fetchData:function(){var e=this;m.a.get("/projects").then(function(t){e.projects=C(t.data,"update_timestamp").reverse()}).catch(function(t){console.log(t),e.$message.error({message:"获取项目失败啦，检查下你的网络吧"})})},see:function(e){this.$router.push({path:"/project/"+e.project_id}),console.log(e)},start:function(e){var t=this;console.log(e),m.a.put("/project_action/"+e.project_id,JSON.stringify({action:"start"}),{headers:{"Content-Type":"application/json"}}).then(function(){var e=t;setTimeout(function(){e.fetchData(),e.$message.success({message:"启动项目成功"})},1e3)}).catch(function(){t.$message.error({message:"启动项目失败请检查网络设置"})})},stop:function(e){var t=this;console.log(e),m.a.put("/project_action/"+e.project_id,JSON.stringify({action:"stop"}),{headers:{"Content-Type":"application/json"}}).then(function(){var e=t;setTimeout(function(){e.fetchData(),e.$message.success({message:"停止项目成功"})},1e3)}).catch(function(){t.$message.error({message:"停止项目失败请检查网络设置"})})},delete_project:function(e){var t=this,r=e.project_id;this.$confirm("此操作将删除项目, 是否删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){m.a.delete("/project/"+r).then(function(){t.$message.success({message:"成功删除"}),t.fetchData()}).catch(function(){t.$message.error({message:"删除失败，请检查网络"})})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},handleSizeChange:function(e){this.pagesize=e,console.log("每页 ".concat(e," 条"))},handleCurrentChange:function(e){this.currentPage=e,console.log("当前页: ".concat(e))}}},P=S,q=(r("lguo"),Object(i["a"])(P,$,z,!1,null,"7e0de27e",null)),D=q.exports,N=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"database"}},[r("el-tabs",{attrs:{id:"eltabs",type:"card"},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[r("el-tab-pane",{attrs:{label:"数据库管理",name:"db_management"}},[r("el-table",{staticStyle:{width:"100%"},attrs:{id:"dbtable",data:e.db_data.slice((e.currentPage-1)*e.pagesize,e.currentPage*e.pagesize),stripe:"","default-sort":{prop:"update_timestamp",order:"descending"}}},[r("el-table-column",{attrs:{prop:"database_name",label:"连接名"}}),e._v(" "),r("el-table-column",{attrs:{prop:"update_timestamp",label:"更新时间"}}),e._v(" "),r("el-table-column",{attrs:{fixed:"right",label:"操作",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(r){e.handleClick(t.row)}}},[e._v("查看")]),e._v(" "),r("el-button",{attrs:{type:"primary",size:"small"}},[e._v("编辑")]),e._v(" "),r("el-button",{attrs:{type:"primary",size:"small"}},[e._v("删除")])]}}])})],1),e._v(" "),r("div",{attrs:{id:"letPaginationBottom"}}),e._v(" "),r("el-pagination",{attrs:{id:"ele_pagination","current-page":e.currentPage,"page-sizes":[5,9,10],"page-size":e.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),r("el-tab-pane",[r("span",{attrs:{slot:"label"},slot:"label"},[r("i",{staticClass:"el-icon-circle-plus-outline"}),e._v("添加数据库")]),e._v(" "),r("el-form",{ref:"new_db",attrs:{model:e.new_db,rules:e.form_check_rules,"label-width":"100px"}},[r("el-form-item",{attrs:{label:"连接名",prop:"database_name"}},[r("el-input",{attrs:{suffixIcon:"el-icon-edit"},model:{value:e.new_db.database_name,callback:function(t){e.$set(e.new_db,"database_name",t)},expression:"new_db.database_name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"地址",prop:"config.host"}},[r("el-input",{attrs:{placeholder:"localhost"},model:{value:e.new_db.config.host,callback:function(t){e.$set(e.new_db.config,"host",t)},expression:"new_db.config.host"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"端口",prop:"config.port"}},[r("el-input",{attrs:{placeholder:"3306"},model:{value:e.new_db.config.port,callback:function(t){e.$set(e.new_db.config,"port",e._n(t))},expression:"new_db.config.port"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"数据库名称",prop:"config.database"}},[r("el-input",{attrs:{suffixIcon:"el-icon-edit"},model:{value:e.new_db.config.database,callback:function(t){e.$set(e.new_db.config,"database",t)},expression:"new_db.config.database"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"用户名",prop:"config.user"}},[r("el-input",{attrs:{placeholder:"user"},model:{value:e.new_db.config.user,callback:function(t){e.$set(e.new_db.config,"user",t)},expression:"new_db.config.user"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"密码",prop:"config.password"}},[r("el-input",{attrs:{placeholder:"password",type:"password"},model:{value:e.new_db.config.password,callback:function(t){e.$set(e.new_db.config,"password",t)},expression:"new_db.config.password"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"类型",prop:"db_type"}},[r("el-select",{attrs:{defaultFirstOption:"",placeholder:"请选择"},model:{value:e.new_db.db_type,callback:function(t){e.$set(e.new_db,"db_type",t)},expression:"new_db.db_type"}},e._l(e.db_types,function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForm("new_db")}}},[e._v("立即创建")]),e._v(" "),r("el-button",{on:{click:function(t){e.resetForm("new_db")}}},[e._v("重置")])],1)],1)],1)],1)],1)},T=[],O={name:"Databases",created:function(){this.fetchData()},data:function(){return{activeName:"db_management",new_db:{database_name:"",config:{host:"",port:"",user:"",password:"",database:""},db_type:""},form_check_rules:{database_name:[{required:!0,message:"请输入连接名",trigger:"blur"}],config:{database:[{required:!0,message:"请输入数据库名称",trigger:"blur"}],host:[{required:!0,message:"请输入数据库地址",trigger:"blur"}],port:[{required:!0,message:"请输入数据库端口",trigger:"blur"}],user:[{required:!0,message:"请输入数据库用户名",trigger:"blur"}],password:[{required:!0,message:"请输入数据库密码",trigger:"blur"}]},db_type:[{required:!0,message:"请输入数据库类型",trigger:"blur"}]},db_types:[{value:"mysql",label:"Mysql"},{value:"mongodb",label:"MongoDB"}],currentPage:1,pagesize:9,db_type_default_value:"mysql",db_data:[]}},computed:{total:function(){return this.db_data.length}},methods:{fetchData:function(){var e=this;m.a.get("/databases").then(function(t){e.db_data=t.data}).catch(function(t){console.log(t),e.$message.error({message:"获取数据库失败啦，检查下你的网络吧"})})},submitForm:function(e){var t=this;this.$refs[e].validate(function(r){if(!r)return t.$message.error({message:"请先正确填写数据库配置"}),!1;m.a.put("/databases",JSON.stringify(t.new_db),{headers:{"Content-Type":"application/json"}}).then(function(){t.$message.success({message:"成功添加数据库"}),t.resetForm(e),t.fetchData()}).catch(function(){t.$message.error({message:"添加数据库失败啦请检查你的数据库配置是否能正确连接"})})})},resetForm:function(e){this.$refs[e].resetFields()},handleSizeChange:function(e){this.pagesize=e,console.log("每页 ".concat(e," 条"))},handleCurrentChange:function(e){this.currentPage=e,console.log("当前页: ".concat(e))}}},R=O,E=(r("7yGw"),Object(i["a"])(R,N,T,!1,null,"4064a898",null)),J=E.exports,L=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-steps",{attrs:{active:e.active,finishStatus:"success"}},[r("el-step",{attrs:{title:"步骤 1"}}),e._v(" "),r("el-step",{attrs:{title:"步骤 2"}}),e._v(" "),r("el-step",{attrs:{title:"步骤 3"}})],1),e._v(" "),0==e.active?r("div",[r("el-button",{attrs:{type:"success"},on:{click:e.next_exist_script}},[e._v("选择已有脚本")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.next_non_exist_script}},[e._v("新建脚本")])],1):e._e(),e._v(" "),1==e.active?[e.new_spider?[r("el-form",{ref:"projectForm",staticClass:"demo-projectForm",attrs:{model:e.projectForm,rules:e.rules,labelWidth:"100px"}},[r("el-form-item",{attrs:{label:"项目名称",prop:"project_name"}},[r("el-input",{model:{value:e.projectForm.project_name,callback:function(t){e.$set(e.projectForm,"project_name",t)},expression:"projectForm.project_name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"脚本名称",prop:"spider_name"}},[r("el-input",{model:{value:e.projectForm.spider_name,callback:function(t){e.$set(e.projectForm,"spider_name",t)},expression:"projectForm.spider_name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"起始URL",prop:"start_url"}},[r("el-input",{model:{value:e.projectForm.start_url,callback:function(t){e.$set(e.projectForm,"start_url",t)},expression:"projectForm.start_url"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"遵守rbots.txt",prop:"obey_robots"}},[r("el-switch",{attrs:{activeText:"on",inactiveText:"off"},model:{value:e.projectForm.obey_robots,callback:function(t){e.$set(e.projectForm,"obey_robots",t)},expression:"projectForm.obey_robots"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"重复抓取",prop:"repeat_enabled"}},[r("el-switch",{attrs:{activeText:"on",inactiveText:"off"},model:{value:e.projectForm.repeat_enabled,callback:function(t){e.$set(e.projectForm,"repeat_enabled",t)},expression:"projectForm.repeat_enabled"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"使用代理",prop:"proxy_enabled"}},[r("el-switch",{attrs:{activeText:"on",inactiveText:"off"},model:{value:e.projectForm.proxy_enabled,callback:function(t){e.$set(e.projectForm,"proxy_enabled",t)},expression:"projectForm.proxy_enabled"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"选择数据库",prop:"databases"}},[r("el-select",{attrs:{placeholder:"请选择"},model:{value:e.choosed_database,callback:function(t){e.choosed_database=t},expression:"choosed_database"}},e._l(e.databases,function(t){return r("el-option",{key:t.database_id,attrs:{value:t.database_id}},[e._v("\n                            "+e._s(t.database_name)+"\n                        ")])}))],1),e._v(" "),r("el-form-item",{attrs:{label:"标签",prop:"tag"}},[r("el-input",{model:{value:e.projectForm.tag,callback:function(t){e.$set(e.projectForm,"tag",t)},expression:"projectForm.tag"}})],1),e._v(" "),r("el-button",{staticStyle:{"margin-top":"12px"},on:{click:e.next_step}},[e._v("下一步")])],1)]:[r("el-form",{ref:"projectForm",staticClass:"demo-projectForm",attrs:{model:e.projectForm,rules:e.rules,labelWidth:"100px"}},[r("el-form-item",{attrs:{label:"项目名称",prop:"project_name"}},[r("el-input",{model:{value:e.projectForm.project_name,callback:function(t){e.$set(e.projectForm,"project_name",t)},expression:"projectForm.project_name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"选择脚本",prop:"spider_name"}},[r("el-select",{attrs:{placeholder:"请选择"},model:{value:e.projectForm.spider_name,callback:function(t){e.$set(e.projectForm,"spider_name",t)},expression:"projectForm.spider_name"}},e._l(e.spiders,function(e,t){return r("el-option",{key:e,attrs:{value:t}})}))],1),e._v(" "),r("el-form-item",{attrs:{label:"选择数据库",prop:"databases"}},[r("el-select",{attrs:{placeholder:"请选择"},model:{value:e.choosed_database,callback:function(t){e.choosed_database=t},expression:"choosed_database"}},e._l(e.databases,function(t){return r("el-option",{key:t.database_id,attrs:{value:t.database_id}},[e._v("\n                            "+e._s(t.database_name)+"\n                        ")])}))],1),e._v(" "),r("el-button",{staticStyle:{"margin-top":"12px"},on:{click:e.next_step}},[e._v("下一步")])],1)]]:2==e.active?[r("el-form",{ref:"projectForm",staticClass:"demo-projectForm",attrs:{model:e.projectForm,rules:e.rules,labelWidth:"100px"}},[r("el-card",[r("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[r("span",[e._v("通知配置")])]),e._v(" "),r("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[r("el-input",{model:{value:e.projectForm.name,callback:function(t){e.$set(e.projectForm,"name",t)},expression:"projectForm.name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"微信",prop:"wechat"}},[r("el-input",{model:{value:e.projectForm.desc,callback:function(t){e.$set(e.projectForm,"desc",t)},expression:"projectForm.desc"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"Webhook",prop:"webhook"}},[r("el-input",{model:{value:e.projectForm.desc,callback:function(t){e.$set(e.projectForm,"desc",t)},expression:"projectForm.desc"}})],1),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForm("projectForm")}}},[e._v("立即创建")])],1)],1)]:e._e()],2)},B=[],W={name:"New_project",created:function(){this.get_spiders(),this.get_databases()},data:function(){return{spiders:{},databases:{},new_spider:!0,active:0,projectForm:{project_name:"",spider_name:"",spidercls:"",database_id:null,infomation_config:{},start_url:"",obey_robots:!0,repeat_enabled:!1,proxy_enabled:!1,database_config:{},tag:"",cron_config:{}},rules:{project_name:{required:!0,message:"请输入项目名称",trigger:"blur"},spider_name:{required:!0,message:"请输入脚本名",trigger:"blur"},start_url:{required:!0,message:"请输入起始URL",trigger:"blur"}}}},computed:{choosed_database:{get:function(){return null===this.projectForm.database_id?null:this.databases[this.projectForm.database_id].database_name},set:function(e){console.log(e),this.projectForm.database_id=e}},post_projectForm:function(){var e={project_name:this.projectForm.project_name,setting:{infomation_config:this.projectForm.infomation_config,start_url:this.projectForm.start_url,obey_robots:this.projectForm.obey_robots,repeat_enabled:this.projectForm.repeat_enabled,proxy_enabled:this.projectForm.proxy_enabled,spidercls:this.spiders[this.projectForm.spider_name],database_config:this.databases[this.projectForm.database_id].config},tag:"",cron_config:this.projectForm.cron_config};return console.log(e),e}},methods:{get_spiders:function(){var e=this;m.a.get("/spiders").then(function(t){e.spiders=t.data}).catch(function(t){console.log(t),e.$message.error({message:"获取脚本失败啦，检查下你的网络吧"})})},get_databases:function(){var e=this;m.a.get("/databases").then(function(t){var r=!0,a=!1,o=void 0;try{for(var n,s=t.data[Symbol.iterator]();!(r=(n=s.next()).done);r=!0){var l=n.value;e.databases[l.database_id]=l}}catch(e){a=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(a)throw o}}console.log(e.databases)}).catch(function(t){console.log(t),e.$message.error({message:"获取数据库失败啦，检查下你的网络吧"})})},next:function(){this.active++},next_step:function(){var e=this;this.$refs["projectForm"].validate(function(t){if(!t)return console.log("illegal next setp"),!1;console.log("legal next setp"),e.next()})},next_exist_script:function(){this.next(),this.new_spider=!1},next_non_exist_script:function(){this.next(),this.new_spider=!0},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;console.log(e),m.a.put("/projects",JSON.stringify(t.post_projectForm),{headers:{"Content-Type":"application/json"}}).then(function(){t.$router.push({path:"/projects"}),t.$message.success({message:"新建项目成功"})}).catch(function(){t.$message.error({message:"新建项目失败请检查网络设置"})})})}}},M=W,Y=Object(i["a"])(M,L,B,!1,null,null,null),V=Y.exports,U=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-steps",{attrs:{active:e.active}},[r("el-step",{attrs:{title:"步骤 1",icon:"el-icon-edit"}}),e._v(" "),r("el-step",{attrs:{title:"规则配置",icon:"el-icon-edit"}})],1),e._v(" "),1==e.active?[e._m(0),e._v(" "),r("el-form",{ref:"gov_projectForm",attrs:{model:e.gov_projectForm,rules:e.rules,labelWidth:"100px"}},[r("el-form-item",{attrs:{label:"项目名称",prop:"project_name"}},[r("el-input",{model:{value:e.gov_projectForm.project_name,callback:function(t){e.$set(e.gov_projectForm,"project_name",t)},expression:"gov_projectForm.project_name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"脚本名称",prop:"setting.spider_name"}},[r("el-input",{model:{value:e.gov_projectForm.setting.spider_name,callback:function(t){e.$set(e.gov_projectForm.setting,"spider_name",t)},expression:"gov_projectForm.setting.spider_name"}}),e._v(" "),r("el-tag",{attrs:{type:"info"}},[e._v("(建议是项目名称的拼音)")])],1),e._v(" "),r("el-form-item",{attrs:{label:"起始URL",prop:"setting.start_url"}},[r("el-input",{model:{value:e.gov_projectForm.setting.start_url,callback:function(t){e.$set(e.gov_projectForm.setting,"start_url",t)},expression:"gov_projectForm.setting.start_url"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"标签",prop:"tag"}},[r("el-input",{model:{value:e.gov_projectForm.tag,callback:function(t){e.$set(e.gov_projectForm,"tag",t)},expression:"gov_projectForm.tag"}})],1),e._v(" "),r("el-form-item",[r("el-button",{staticStyle:{"margin-top":"12px"},on:{click:e.next_step}},[e._v("下一步")]),e._v(" "),r("el-button",{on:{click:function(t){e.resetForm("gov_projectForm")}}},[e._v("重置")])],1)],1)]:e._e(),e._v(" "),2==e.active?[e._m(1),e._v(" "),r("el-tag",{attrs:{type:"info"}},[e._v("例子：温*市和温州市")]),e._v(" "),r("el-form",{ref:"gov_projectForm2",attrs:{inline:!0,model:e.gov_projectForm,labelWidth:"100px"}},e._l(e.gov_projectForm.setting.rules,function(t,a){return r("div",[r("el-form-item",{attrs:{label:"匹配词",rules:{required:!0,message:"值不能为空",trigger:"blur"},prop:"setting.rules."+a+".0"}},[r("el-input",{model:{value:t[0],callback:function(r){e.$set(t,0,r)},expression:"rule[0]"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"正确词",rules:{required:!0,message:"值不能为空",trigger:"blur"},prop:"setting.rules."+a+".1"}},[r("el-input",{model:{value:t[1],callback:function(r){e.$set(t,1,r)},expression:"rule[1]"}})],1),e._v(" "),r("el-button",{on:{click:function(r){r.preventDefault(),e.removeRule(t)}}},[e._v("删除")])],1)})),e._v(" "),r("el-form",[r("el-form-item",[r("el-button",{on:{click:e.addRule}},[e._v("新增规则")])],1),e._v(" "),r("el-form-item",[r("el-button",{staticStyle:{"margin-top":"12px"},on:{click:e.last}},[e._v("上一步")]),e._v(" "),r("el-button",{staticStyle:{"margin-top":"12px"},attrs:{type:"primary"},on:{click:function(t){e.submitForm("gov_projectForm2")}}},[e._v("立即创建\n                ")])],1)],1)]:e._e()],2)},G=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("p",{attrs:{align:"center"}},[r("b",[e._v("新建政府项目")])])},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("p",{attrs:{align:"center"}},[r("b",[e._v("纠错规则配置(*号代表模糊匹配的字)")])])}],H=r("vqbQ"),I={components:{ElFormItem:H["a"]},name:"New_gov_project",data:function(){return{active:1,gov_projectForm:{project_name:"",setting:{information_config:{},start_url:"",obey_robots:!1,repeat_enabled:!1,proxy_enabled:!1,spider_name:"",spidercls:"",rules:[],database_config:{},script_type:"gov"},tag:"",cron_config:{}},rules:{project_name:{required:!0,message:"请输入项目名称",trigger:"blur"},setting:{spider_name:{required:!0,message:"请输入爬虫脚本名称",trigger:"blur"},start_url:[{required:!0,message:"请输入起始网址",trigger:"blur"},{type:"url",message:"网址需要以http开头"}]}}}},methods:{submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;m.a.put("/projects",JSON.stringify(t.gov_projectForm),{headers:{"Content-Type":"application/json"}}).then(function(){t.$router.push({path:"/projects"}),t.$message.success({message:"新建政府项目成功"})}).catch(function(){t.$message.error({message:"新建政府项目失败请检查网络设置"})})})},resetForm:function(e){this.$refs[e].resetFields()},last:function(){this.active--},next:function(){this.active++},next_step:function(){var e=this;this.$refs["gov_projectForm"].validate(function(t){if(!t)return console.log("illegal next setp"),!1;console.log("legal next setp"),e.next()})},removeRule:function(e){var t=this.gov_projectForm.setting.rules.indexOf(e);-1!==t&&this.gov_projectForm.setting.rules.splice(t,1)},addRule:function(){this.gov_projectForm.setting.rules.push([])}}},Z=I,K=Object(i["a"])(Z,U,G,!1,null,null,null),Q=K.exports,X=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"project_detail"}},[r("el-tabs",{attrs:{type:"card"},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[r("el-tab-pane",{attrs:{label:"已爬取网站列表",name:"task"}},[r("el-table",{staticClass:"fix_height_table",staticStyle:{width:"100%"},attrs:{data:e.computed_task,stripe:""}},[r("el-table-column",{attrs:{label:"爬取链接",width:"600"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-popover",{attrs:{trigger:"hover",placement:"bottom-start",width:"400"}},[r("p",{staticClass:"popword"},[e._v(e._s(t.row.full_url))]),e._v(" "),r("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[r("a",{staticClass:"link",attrs:{target:"_blank",href:t.row.full_url}},[e._v(e._s(t.row.short_url))])])])]}}])}),e._v(" "),r("el-table-column",{attrs:{prop:"update_timestamp",label:"爬取时间"}})],1),e._v(" "),r("div"),e._v(" "),r("el-pagination",{attrs:{"current-page":e.task_currentPage,"page-sizes":[5,9,10],"page-size":e.task_pagesize,layout:"total, sizes, prev, pager, next, jumper",total:e.task_total},on:{"size-change":e.task_handleSizeChange,"current-change":e.task_handleCurrentChange}})],1),e._v(" "),r("el-tab-pane",{attrs:{label:"不符合规则的结果",name:"error_word"}},[r("el-tag",[e._v("检索结果仅代表不匹配结果（也有可能语义在上下文中是正确的，请继续人工筛选）")]),e._v(" "),[r("el-select",{attrs:{clearable:"",placeholder:"请选择正确词"},on:{change:e.update_computed_error_word},model:{value:e.select_lexicon_correct_word,callback:function(t){e.select_lexicon_correct_word=t},expression:"select_lexicon_correct_word"}},e._l(e.project_lexicon_data,function(t){return r("el-option",{key:t.rule_id,attrs:{label:" 正确词:"+t.correct_word,value:t.correct_word}},[r("span",{staticStyle:{float:"left"}},[e._v(e._s(t.correct_word))])])}))],e._v(" "),r("el-table",{staticClass:"fix_height_table",staticStyle:{width:"100%"},attrs:{data:e.computed_error_word.slice((e.error_word_currentPage-1)*e.error_word_pagesize,e.error_word_currentPage*e.error_word_pagesize),stripe:""}},[r("el-table-column",{attrs:{type:"index",width:"50",label:"序号"}}),e._v(" "),r("el-table-column",{attrs:{label:"网址",width:"500"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-popover",{attrs:{trigger:"hover",placement:"bottom-start",width:"400"}},[r("p",{staticClass:"popword"},[e._v(e._s(t.row.full_url))]),e._v(" "),r("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[r("a",{staticClass:"link",attrs:{target:"_blank",href:t.row.full_url}},[e._v(e._s(t.row.short_url))])])])]}}])}),e._v(" "),r("el-table-column",{attrs:{prop:"correct_word",label:"正确词"}}),e._v(" "),r("el-table-column",{attrs:{prop:"error_word",label:"错误词"}}),e._v(" "),r("el-table-column",{attrs:{prop:"update_timestamp",label:"检索时间"}}),e._v(" "),r("el-table-column",{attrs:{fixed:"right",label:"分析",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("a",{attrs:{target:"_blank",href:"/location/"+t.row.result_id+"?type=real&error_word="+t.row.error_word}},[r("el-button",{attrs:{type:"primary",size:"small"}},[e._v("实时定位\n                            ")])],1),e._v(" "),r("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(r){e.delete_result(t.row.result_id)}}},[e._v("已解决\n                        ")])]}}])})],1),e._v(" "),r("el-pagination",{attrs:{"current-page":e.error_word_currentPage,"page-sizes":[5,9,10],"page-size":e.error_word_pagesize,layout:"total, sizes, prev, pager, next, jumper",total:e.error_word_total},on:{"size-change":e.error_word_handleSizeChange,"current-change":e.error_word_handleCurrentChange}}),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.delete_results("error_word")}}},[e._v("删除全部")])],2),e._v(" "),r("el-tab-pane",{attrs:{label:"错误链接列表",name:"error_link"}},[r("el-table",{staticClass:"fix_height_table",staticStyle:{width:"100%"},attrs:{id:"resulttable",data:e.computed_error_link.slice((e.error_link_currentPage-1)*e.error_link_pagesize,e.error_link_currentPage*e.error_link_pagesize),stripe:""}},[r("el-table-column",{attrs:{type:"index",width:"50",label:"序号"}}),e._v(" "),r("el-table-column",{attrs:{label:"错误链接"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-popover",{attrs:{trigger:"hover",placement:"bottom-start",width:"400"}},[r("p",{staticClass:"popword"},[e._v(e._s(t.row.full_url))]),e._v(" "),r("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[r("a",{staticClass:"link",attrs:{target:"_blank",href:t.row.full_url}},[e._v(e._s(t.row.short_url))])])])]}}])}),e._v(" "),r("el-table-column",{attrs:{width:"200",prop:"update_timestamp",label:"解析时间"}}),e._v(" "),r("el-table-column",{attrs:{fixed:"right",label:"分析",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("a",{attrs:{target:"_blank",href:"/location/"+t.row.result_id+"?type=real"}},[r("el-button",{attrs:{type:"primary",size:"small"}},[e._v("实时定位\n                            ")])],1),e._v(" "),r("a",{attrs:{target:"_blank",href:"/location/"+t.row.result_id+"?type=cache"}},[r("el-button",{attrs:{type:"primary",size:"small"}},[e._v("缓存定位\n                            ")])],1),e._v(" "),r("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(r){e.delete_result(t.row.result_id)}}},[e._v("已解决\n                        ")])]}}])})],1),e._v(" "),r("el-pagination",{attrs:{"current-page":e.error_link_currentPage,"page-sizes":[5,9,10],"page-size":e.error_link_pagesize,layout:"total, sizes, prev, pager, next, jumper",total:e.error_link_total},on:{"size-change":e.error_link_handleSizeChange,"current-change":e.error_link_handleCurrentChange}}),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.delete_results("error_link")}}},[e._v("删除全部")])],1),e._v(" "),r("el-tab-pane",{attrs:{label:"政府关键词库",name:"gov_lexicon"}},[r("el-table",{staticClass:"fix_height_table",staticStyle:{width:"100%"},attrs:{id:"lexicontable",data:e.project_lexicon_data.slice((e.lexicon_currentPage-1)*e.lexicon_pagesize,e.lexicon_currentPage*e.lexicon_pagesize),stripe:"","default-sort":{prop:"update_timestamp",order:"descending"}}},[r("el-table-column",{attrs:{prop:"pattern",label:"匹配词"}}),e._v(" "),r("el-table-column",{attrs:{prop:"correct_word",label:"正确词"}}),e._v(" "),r("el-table-column",{attrs:{prop:"domain",label:"域名"}}),e._v(" "),r("el-table-column",{attrs:{prop:"update_timestamp",label:"更新时间"}}),e._v(" "),r("el-table-column",{attrs:{fixed:"right",label:"操作",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(r){e.deleteRule(t.row.rule_id)}}},[e._v("删除")])]}}])})],1),e._v(" "),r("el-pagination",{attrs:{id:"ele_pagination","current-page":e.lexicon_currentPage,"page-sizes":[5,9,10],"page-size":e.lexicon_pagesize,layout:"total, sizes, prev, pager, next, jumper",total:e.lexicon_total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),r("el-tab-pane",[r("span",{attrs:{slot:"label"},slot:"label"},[r("i",{staticClass:"el-icon-circle-plus-outline"}),e._v("添加规则")]),e._v(" "),r("el-form",{ref:"gov_rule_form",attrs:{inline:!0,model:e.gov_rule_form}},[r("el-tag",{staticStyle:{margin:"10px"},attrs:{type:"success"}},[e._v("示例： 匹配词：中*国 正确词：中华人民共和国\n                ")]),e._v(" "),e._l(e.gov_rule_form.gov_rules,function(t,a){return r("div",[r("el-form-item",{attrs:{label:"匹配词",rules:{required:!0,message:"匹配词不能为空",trigger:"blur"},prop:"gov_rules."+a+".0"}},[r("el-input",{model:{value:t[0],callback:function(r){e.$set(t,0,r)},expression:"gov_rule[0]"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"正确词",rules:{required:!0,message:"正确词不能为空",trigger:"blur"},prop:"gov_rules."+a+".1"}},[r("el-input",{model:{value:t[1],callback:function(r){e.$set(t,1,r)},expression:"gov_rule[1]"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"网站地址",rules:[{required:!0,message:"网站地址不能为空",trigger:"blur"},{type:"url",message:"请输入正确的网站地址",trigger:["blur","change"]}],prop:"gov_rules."+a+".2"}},[r("el-input",{model:{value:t[2],callback:function(r){e.$set(t,2,r)},expression:"gov_rule[2]"}})],1),e._v(" "),r("el-button",{on:{click:function(r){r.preventDefault(),e.removeRule(t)}}},[e._v("删除")])],1)}),e._v(" "),r("el-button",{on:{click:function(t){return t.preventDefault(),e.addRule(t)}}},[e._v("新增规则")]),e._v(" "),r("el-button",{staticStyle:{"margin-top":"12px"},attrs:{type:"primary"},on:{click:function(t){e.lexicon_submitForm("gov_rule_form")}}},[e._v("\n                    立即添加\n                ")])],2)],1)],1)],1)},A=[],ee=(r("Z2Ku"),r("L9s1"),r("oalD")),te=r("0YiY"),re={components:{ElButton:te["a"],ElTabPane:ee["a"]},name:"Project",created:function(){this.fetchData()},data:function(){return{activeName:"task",project_data:{project_id:"",project_name:"",setting:{rules:[],spidercls:"",start_url:"",obey_robots:!1,script_type:"",spider_name:"",proxy_enabled:!1,repeat_enabled:!1,database_config:{},information_config:{}},cron_config:{},tag:"",status:"",is_deleted:!1,update_timestamp:"",create_timestamp:""},task_data:{total_count:"",count:"",result:[]},task_currentPage:1,task_pagesize:9,select_lexicon_correct_word:"",error_word:{total_count:"",count:"",result:[]},current_correct_word_show:"all",error_link:{total_count:"",count:"",result:[]},error_word_currentPage:1,error_word_pagesize:5,error_link_currentPage:1,error_link_pagesize:5,gov_lexicon_data:[],gov_rule_form:{gov_rules:[["","",""]]},lexicon_currentPage:1,lexicon_pagesize:9}},computed:{computed_task:function(){var e=[],t=!0,r=!1,a=void 0;try{for(var o,n=this.task_data.result[Symbol.iterator]();!(t=(o=n.next()).done);t=!0){var s=o.value,l=s.url;s.url.length>66&&(l=s.url.slice(0,66)+"...");var i={full_url:s.url,short_url:l,update_timestamp:s.update_timestamp};e.push(i)}}catch(e){r=!0,a=e}finally{try{t||null==n.return||n.return()}finally{if(r)throw a}}return console.log(e),e},computed_error_word:function(){var e=[],t=!0,r=!1,a=void 0;try{for(var o,n=this.error_word.result[Symbol.iterator]();!(t=(o=n.next()).done);t=!0){var s=o.value,l=JSON.stringify(s.result);l.length>66&&l.slice(0,66)+"...";var i=s.result.url;s.result.url.length>66&&(i=s.result.url.slice(0,66)+"...");var c={result_id:s.result_id,full_url:s.result.url,short_url:i,reason:s.result.reason,correct_word:s.result.error.correct,error_word:s.result.error.error,update_timestamp:s.update_timestamp},u=this.current_correct_word_show;"all"!==u&&u!==c.correct_word||e.push(c)}}catch(e){r=!0,a=e}finally{try{t||null==n.return||n.return()}finally{if(r)throw a}}return console.log(e),e},computed_error_link:function(){var e=[],t=!0,r=!1,a=void 0;try{for(var o,n=this.error_link.result[Symbol.iterator]();!(t=(o=n.next()).done);t=!0){var s=o.value,l=JSON.stringify(s.result);l.length>66&&l.slice(0,66)+"...";var i=s.result.url;s.result.url.length>66&&(i=s.result.url.slice(0,66)+"...");var c={result_id:s.result_id,full_url:s.result.url,short_url:i,reason:s.result.reason,update_timestamp:s.update_timestamp};e.push(c)}}catch(e){r=!0,a=e}finally{try{t||null==n.return||n.return()}finally{if(r)throw a}}return console.log(e),e},project_lexicon_data:function(){if(void 0===this.project_data.setting.start_url)return[];var e=[],t=!0,r=!1,a=void 0;try{for(var o,n=this.gov_lexicon_data[Symbol.iterator]();!(t=(o=n.next()).done);t=!0){var s=o.value;!0===this.project_data.setting.start_url.includes(s.domain)&&e.push(s)}}catch(e){r=!0,a=e}finally{try{t||null==n.return||n.return()}finally{if(r)throw a}}return e},task_total:function(){return Number(this.task_data.total_count)>1e3?1e3:Number(this.task_data.total_count)},error_word_total:function(){return Number(this.computed_error_word.length)},error_link_total:function(){return Number(this.computed_error_link.length)},lexicon_total:function(){return this.project_lexicon_data.length}},methods:{fetchData:function(){this.fetchProjectData(),this.fetchTaskData(),this.fetch_error_word_data(),this.fetch_error_link_data(),this.fetch_lexicon_data()},fetchProjectData:function(){var e=this;m.a.get("/project/"+this.$route.params.project_id).then(function(t){console.log(t.data),e.project_data=t.data}).catch(function(t){console.log(t),e.$message.error({message:"获取项目数据失败啦，检查下你的网络吧"})})},fetchTaskData:function(){var e=this;m.a.get("/task/"+this.$route.params.project_id+"?limit="+this.task_pagesize+"&page="+this.task_currentPage).then(function(t){console.log(t.data),e.task_data=t.data}).catch(function(t){console.log(t),e.$message.error({message:"获取任务列表失败啦，检查下你的网络吧"})})},fetch_error_word_data:function(){var e=this;m.a.get("/results/"+this.$route.params.project_id+"?type=error_word").then(function(t){console.log(t.data),e.error_word=t.data}).catch(function(t){console.log(t),e.$message.error({message:"获取错误列表失败啦，检查下你的网络吧"})})},fetch_error_link_data:function(){var e=this;m.a.get("/results/"+this.$route.params.project_id+"?type=error_link").then(function(t){console.log(t.data),e.error_link=t.data}).catch(function(t){console.log(t),e.$message.error({message:"获取错误链接列表失败啦，检查下你的网络吧"})})},fetch_lexicon_data:function(){var e=this;m.a.get("/gov_lexicon").then(function(t){e.gov_lexicon_data=t.data}).catch(function(t){console.log(t),e.$message.error({message:"获取政府词库列表失败啦，检查下你的网络吧"})})},task_handleSizeChange:function(e){this.task_pagesize=e,this.fetchTaskData(),console.log("每页 ".concat(e," 条"))},task_handleCurrentChange:function(e){this.task_currentPage=e,this.fetchTaskData(),console.log("当前页: ".concat(e))},error_word_handleSizeChange:function(e){this.error_word_pagesize=e,console.log("每页 ".concat(e," 条"))},error_link_handleSizeChange:function(e){this.error_link_pagesize=e,console.log("每页 ".concat(e," 条"))},error_word_handleCurrentChange:function(e){this.error_word_currentPage=e,console.log("当前页: ".concat(e))},error_link_handleCurrentChange:function(e){this.error_link_currentPage=e,console.log("当前页: ".concat(e))},update_computed_error_word:function(){this.current_correct_word_show=this.select_lexicon_correct_word,this.error_word_currentPage=1},delete_results:function(e){var t=this;console.log(e),this.$confirm("此操作将删除该项目所有不符合规则的结果, 是否删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){m.a.delete("/results/"+t.$route.params.project_id+"?type="+e).then(function(){t.$message.success({message:"成功删除"}),t.fetch_error_link_data(),t.fetch_error_word_data()}).catch(function(){t.$message.error({message:"删除失败，请检查网络"})})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},delete_result:function(e){var t=this;this.$confirm("此操作将删除记录, 是否删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){m.a.delete("/result/"+e).then(function(){t.$message.success({message:"成功删除"}),t.fetch_error_link_data(),t.fetch_error_word_data()}).catch(function(){t.$message.error({message:"删除失败，请检查网络"})})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},lexicon_submitForm:function(e){var t=this;this.$refs[e].validate(function(r){if(!r)return t.$message.error({message:"请先正确填写规则"}),!1;m.a.put("/gov_lexicon",JSON.stringify(t.gov_rule_form),{headers:{"Content-Type":"application/json"}}).then(function(){t.$message.success({message:"成功添加规则至词库"}),t.resetForm(e),t.fetch_lexicon_data()}).catch(function(){t.$message.error({message:"添加规则失败啦"})})})},resetForm:function(e){this.$refs[e].resetFields()},handleSizeChange:function(e){this.lexicon_pagesize=e,console.log("每页 ".concat(e," 条"))},handleCurrentChange:function(e){this.lexicon_currentPage=e,console.log("当前页: ".concat(e))},removeRule:function(e){var t=this.gov_rule_form.gov_rules.indexOf(e);-1!==t&&this.gov_rule_form.gov_rules.splice(t,1)},addRule:function(){var e=this.gov_rule_form.gov_rules;0!==e.length?e.push(["","",e[e.length-1][2]]):e.push(["","",""])},deleteRule:function(e){var t=this;m.a.delete("/gov_lexicon/"+e).then(function(){t.$message.success({message:"成功删除规则"}),t.fetch_lexicon_data()}).catch(function(){t.$message.error({message:"删除规则失败，请检查网络"})})}}},ae=re,oe=(r("Wvv0"),Object(i["a"])(ae,X,A,!1,null,"9cd0a572",null)),ne=oe.exports,se=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-form",[r("label",[e._v("引用地址")]),e._v(" "),r("br"),e._v(" "),r("br"),e._v(" "),r("a",{attrs:{href:e.location_data.previous_url,target:"_blank"}},[e._v(e._s(e.location_data.previous_url))]),e._v(" "),r("br"),e._v(" "),r("br"),e._v(" "),r("label",[e._v("源码定位")]),e._v(" "),r("br"),e._v(" "),r("div",{attrs:{id:"code_text"}},[e._v("\n\n            "+e._s(e.location_data.head)+"\n            "),r("div",{domProps:{innerHTML:e._s(e.location_data.body)}}),e._v("\n            "+e._s(e.location_data.foot)+"\n        ")])])],1)},le=[],ie=(r("syjH"),{props:["result_id","location_type"],name:"code_location",created:function(){this.fetch_code_location()},data:function(){return{result_id:"",location_type:"cache",location_data:{previous_url:"",content:""}}},computed:{},methods:{fetch_code_location:function(){var e=this,t=this.$route.fullPath;m.a.get(t).then(function(t){console.log(t.data),e.location_data=t.data}).catch(function(t){console.log(t),e.$message.error({message:"获取定位源码失败啦，检查下你的网络吧"})})}}}),ce=ie,ue=(r("V6YJ"),Object(i["a"])(ce,se,le,!1,null,"69e42bd6",null)),_e=ue.exports;a["default"].use(b["a"]);var pe=[{path:"/",redirect:"/index"},{path:"/index",component:F},{path:"/projects",component:D},{path:"/project/:project_id",component:ne},{path:"/databases",component:J},{path:"/database/:database_id",component:J},{path:"/create_project",component:V},{path:"/create_gov_project",component:Q},{path:"/gov_lexicon",component:h},{path:"/location/:result_id",component:_e,props:!0}],de=new b["a"]({mode:"history",routes:pe}),me=r("XJYT"),ge=r.n(me);r("D66Q");a["default"].use(ge.a),a["default"].component("pyscraper-govlexicon",h),a["default"].config.productionTip=!1,new a["default"]({router:de,render:function(e){return e(u)}}).$mount("#app")},Wvv0:function(e,t,r){"use strict";var a=r("YW2s"),o=r.n(a);o.a},YW2s:function(e,t,r){},ZL7j:function(e,t,r){"use strict";var a=r("00LD"),o=r.n(a);o.a},eN0a:function(e,t,r){"use strict";var a=r("M1ow"),o=r.n(a);o.a},lguo:function(e,t,r){"use strict";var a=r("3gUL"),o=r.n(a);o.a},qj7S:function(e,t,r){}});
//# sourceMappingURL=app.b1328aaf.js.map